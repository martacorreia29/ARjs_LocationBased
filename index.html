<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Location-based AR.js demo</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script type="text/javascript"
        src="https://www.unpkg.com/@ar-js-org/ar.js@3.4.5/three.js/build/ar-threex-location-only.js"></script>
    <script type="text/javascript"
        src="https://www.unpkg.com/@ar-js-org/ar.js@3.4.5/aframe/build/aframe-ar.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
</head>

<body style="margin: 0; overflow: hidden;">
    <a-scene renderer="logarithmicDepthBuffer: true;" vr-mode-ui='enabled: false' embedded arjs='sourceType: webcam;'>
        <a-camera gps-new-camera positionMinAccuracy="10" rotation-reader> </a-camera>
        <a-box id="myobject" color="yellow" look-at="[gps-new-camera]" scale="1 1 1" position="0 0 -1" />
    </a-scene>

    <script>
        // Wait for the scene to load
        document.querySelector('a-scene').addEventListener('loaded', function () {
            // Get the reference to the box
            var box = document.querySelector('#myobject');

            // Function to update box position based on user's location
            function updateBoxPosition(position) {
                // Extract latitude and longitude from position object
                var latitude = position.coords.latitude;
                var longitude = position.coords.longitude;

                // Calculate new position slightly in front of the user
                var distance = 10; // Adjust this value to change the distance
                var latOffset = distance * 0.000008983; // Approximate offset for latitude (1 meter â‰ˆ 0.000008983 degrees)
                var lonOffset = distance * 0.000008983 / Math.cos(latitude * Math.PI / 180); // Approximate offset for longitude

                // Calculate new latitude and longitude
                var newLatitude = latitude + latOffset;
                var newLongitude = longitude + lonOffset;

                // Set box's position to user's location
                box.setAttribute('gps-new-entity-place', {
                    latitude: latitude,
                    longitude: longitude
                });
            }

            // Function to handle errors in geolocation retrieval
            function handleLocationError(error) {
                console.error('Error getting user location:', error);
            }

            // Try to get user's location
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(updateBoxPosition, handleLocationError);
            } else {
                console.error('Geolocation is not supported by this browser.');
            }
        });
    </script>
</body>

</html>